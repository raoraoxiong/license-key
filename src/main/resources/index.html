<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>license</title>
  <script src="./jquery-1.11.3.min.js" type="text/javascript"></script>
</head>
<body>
<p>
  生成软件授权码
</p>
<br>
<div id="table">
</div>
<button id="add" type="button" onclick="generateTable()">添加</button>
<p></p>
<input type="button" value="注册" id="submit"><br>
<div id='response'></div>
<script type="text/javascript">

  function generateTable() {
    var t = '  姓名: <input type="text" name="owner" class="owner" ><br>\n'
        + '  主板序列号: <input type="text" name="boardSn" class="boardSn"><br>\n'
        + '    MAC地址: <input type="text" name="macAdd" class="macAdd"><br>\n'
        + '  系统硬盘序列号: <input type="text" name="hddSn" class="hddSn"><br>\n'
        + '  证书有效期: <input type="date" name="validDate" class="validDate"> <br>\n'
        + ' <br/>'
    //var div = document.createElement('div');
    //var table = document.getElementById('table');
    //div.innerHTML(t);
    //table.appendChild(div);
    $('#table').before(t);
  }

  //发送表单ajax请求
  $("#submit").on('click', function () {

    var jsonData = [];
    var lenth = $('.owner').length;
    for (var i = 0; i < lenth; i++) {
      jsonData[i] = {
        owner: $($('.owner')[i]).val(),
        boardSn: $($('.boardSn')[i]).val(),
        macAdd: $($('.macAdd')[i]).val(),
        hddSn: $($('.hddSn')[i]).val(),
        validDate: $($('.validDate')[i]).val()
      }
    }
    $.ajax({
      url: "/generate",
      type: "POST",
      data: JSON.stringify(jsonData),
      contentType: "application/json",
      success: function (res) {
        $('#response').html("<h1> 生成的注册码</h1> <br>" + JSON.stringify(res) +
            "<br> <a  href='./license-key' >下载证书</a>");
      }
    });
  });
</script>
</body>
</html>